# Set in stage2:
# -------------------------------------------
# set -e +a +m +s +i -f
# . /start/stage2.functions
# VAR_*

writeCrontab(){
   local IFS=$(echo -en "\n\b")
   local tmpFile="$(mktemp)"
   local -
   set +f
   /bin/chown $VAR_LINUX_USER /backup/scripts/*
   /bin/chmod u+x,o= /backup/scripts/*
   set -f
   cronVars="$(set | /bin/grep "VAR_cron_")"
   for cronVar in $cronVars
   do
      name=${cronVar%%=*}
      cron="$(removeSingleQuotes ${cronVar#*=})"
      echo "$cron /backup/scripts/$name" >> "$tmpFile"
   done
   /usr/bin/crontab -u $VAR_LINUX_USER "$tmpFile"
   /bin/rm "$tmpFile"
   /usr/bin/crontab -u $VAR_LINUX_USER -l
}

if [ "$isFirstRun" == "true" ]
then
   writeCrontab
fi
